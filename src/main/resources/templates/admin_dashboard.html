<!DOCTYPE html>
<html lang="th" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î - ‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏°‡∏∑‡∏≠‡∏™‡∏≠‡∏á</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  <link rel="stylesheet" th:href="@{/css/admin-style.css}">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<!-- Sidebar -->
<div class="sidebar">
  <h5 class="text-center mb-3">‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡∏°‡∏∑‡∏≠‡∏™‡∏≠‡∏á</h5>
  <div class="text-center mb-3">üë§ <span>Admin</span></div>
  <a href="/admin/dashboard" class="active">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</a>
  <a href="/admin/products">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</a>
  <a href="/admin/members">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</a>
  <a href="/admin/orders">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</a>
  <a href="/admin/reports">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</a>
  <a href="/admin/settings">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</a>
  <a href="/logout">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</a>
</div>

<!-- Content -->
<div class="content">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h4>üìä ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</h4>
    
  </div>

  <!-- Summary Cards -->
  <div class="row text-center mb-4">
    <div class="col-md-3">
      <div class="card p-3 shadow-sm">
        <h6>‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</h6>
        <h3 th:text="${orderCountToday}">15</h3>
        <small>‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</small>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card p-3 shadow-sm">
        <h6>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</h6>
        <h3 th:text="${totalSalesToday}">24,560</h3>
        <small>‡∏ö‡∏≤‡∏ó</small>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card p-3 shadow-sm">
        <h6>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà</h6>
        <h3 th:text="${newProducts}">8</h3>
        <small>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</small>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card p-3 shadow-sm">
        <h6>‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÉ‡∏´‡∏°‡πà</h6>
        <h3 th:text="${newUsers}">5</h3>
        <small>‡∏Ñ‡∏ô</small>
      </div>
    </div>
  </div>

  <!-- Recent Orders -->
  <div class="card p-3 mb-4">
    <h5 class="mb-3">üßæ ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h5>
    <table class="table table-bordered align-middle text-center">
      <thead class="table-light">
        <tr>
          <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</th>
          <th>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</th>
          <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</th>
          <th>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°</th>
          <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
          <th>‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</th>
        </tr>
      </thead>
      <tbody>
        <tr th:each="o : ${recentOrders}">
          <td th:text="${o.order_code}"></td>
          <td th:text="${o.customer_name}"></td>
          <td th:text="${#temporals.format(o.created_at, 'dd MMM yyyy')}"></td>
          <td th:text="${#numbers.formatDecimal(o.total_price, 0, 'COMMA', 2, 'POINT')} + ' ‡∏ö‡∏≤‡∏ó'"></td>
          <td>
            <span class="badge bg-warning text-dark" th:if="${o.status == '‡∏£‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô'}" th:text="${o.status}"></span>
            <span class="badge bg-info text-dark" th:if="${o.status == '‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß'}" th:text="${o.status}"></span>
            <span class="badge bg-success" th:if="${o.status == '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'}" th:text="${o.status}"></span>
            <span class="badge bg-danger" th:if="${o.status == '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å'}" th:text="${o.status}"></span>
          </td>
          <td>
            <a th:href="@{'/admin/orders/edit/' + ${o.id}}" class="btn btn-sm btn-outline-primary">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</a>
            <a th:href="@{'/admin/orders/delete/' + ${o.id}}" class="btn btn-sm btn-outline-danger"
               onclick="return confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')">‡∏•‡∏ö</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Chart Section -->
  <div class="card p-4 shadow-sm mb-5">
    <h5 class="mb-3">üìà ‡∏Å‡∏£‡∏≤‡∏ü‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</h5>
    <canvas id="salesChart" height="120"></canvas>
  </div>

  <!-- Add New Product -->
  <div class="card p-3">
    <h5 class="mb-3">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà</h5>
    <form action="/admin/products/add" method="post" enctype="multipart/form-data" class="row g-3">
      <div class="col-md-6">
        <label class="form-label">‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
        <input type="text" name="name" class="form-control" required>
      </div>
      <div class="col-md-6">
        <label class="form-label">‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠</label>
        <input type="text" name="brand" class="form-control" required>
      </div>
      <div class="col-md-4">
        <label class="form-label">‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ö‡∏≤‡∏ó)</label>
        <input type="number" step="0.01" name="price" class="form-control" required>
      </div>
      <div class="col-md-4">
        <label class="form-label">‡∏™‡∏†‡∏≤‡∏û</label>
        <select name="condition" class="form-select">
          <option>90%</option>
          <option>95%</option>
          <option>‡πÉ‡∏´‡∏°‡πà</option>
        </select>
      </div>
      <div class="col-md-4">
        <label class="form-label">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà / ‡πÑ‡∏ã‡∏ã‡πå</label>
        <input type="text" name="category" class="form-control" placeholder="‡πÄ‡∏ä‡πà‡∏ô US 8, US 9">
      </div>
      <div class="col-md-12">
        <label class="form-label">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
        <textarea name="description" rows="2" class="form-control"></textarea>
      </div>
      <div class="col-md-6">
        <label class="form-label">‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</label>
        <input type="file" name="file" class="form-control">
      </div>
      <div class="col-md-6 d-flex align-items-end">
        <button type="submit" class="btn btn-success w-100">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà</button>
      </div>
    </form>
  </div>
</div>

<!-- Chart Script -->
<script th:inline="javascript">
/*<![CDATA[*/
  const months = /*[[${months}]]*/ [];
  const salesTotals = /*[[${salesTotals}]]*/ [];
  const orderCounts = /*[[${orderCounts}]]*/ [];

  new Chart(document.getElementById('salesChart'), {
    type: 'bar',
    data: {
      labels: months.map(m => "‡πÄ‡∏î‡∏∑‡∏≠‡∏ô " + m),
      datasets: [
        {
          label: '‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ (‡∏ö‡∏≤‡∏ó)',
          data: salesTotals,
          backgroundColor: 'rgba(54,162,235,0.6)',
          borderColor: 'rgba(54,162,235,1)',
          borderWidth: 1,
          yAxisID: 'y1'
        },
        {
          label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠',
          data: orderCounts,
          type: 'line',
          fill: false,
          borderColor: 'rgba(255,99,132,1)',
          tension: 0.3,
          yAxisID: 'y2'
        }
      ]
    },
    options: {
      responsive: true,
      interaction: { mode: 'index', intersect: false },
      scales: {
        y1: {
          type: 'linear',
          display: true,
          position: 'left',
          beginAtZero: true,
          title: { display: true, text: '‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ (‡∏ö‡∏≤‡∏ó)' }
        },
        y2: {
          type: 'linear',
          display: true,
          position: 'right',
          beginAtZero: true,
          grid: { drawOnChartArea: false },
          title: { display: true, text: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠' }
        }
      }
    }
  });
/*]]>*/
</script>

</body>
</html>
